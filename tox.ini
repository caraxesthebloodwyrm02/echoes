[tox]
envlist = py312, py313
skip_missing_interpreters = true

[testenv]
deps =
    -r requirements.txt
    pytest>=8.0.0
    pytest-cov>=4.0.0
    pytest-xdist>=3.0.0
    black>=24.0.0
    ruff>=0.1.0
    mypy>=1.0.0

commands =
    # Install package in development mode
    pip install -e .

    # Run security checks
    pip-audit --format json

    # Run code quality checks
    black --check --diff .
    ruff check .
    mypy . --ignore-missing-imports || true

    # Run tests
    pytest test_integration_quick.py -v
    pytest test_integration.py -v --tb=short || true

    # Run API key check (will skip if no key)
    python check_api_key.py || echo "API key check skipped (expected)"

[testenv:py312]
basepython = python3.12

[testenv:py313]
basepython = python3.13
