name: Continuous Deployment

on:
  registry_package:
    types: [published]

jobs:
  deploy:
    name: Deploy to Production
    runs-on: ubuntu-latest

    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Deploy to production
        run: |
          echo "Deploying version ${{ github.event.package.package_version.container_metadata.tag.name }} to production..." # This context is available for the 'registry_package' event.
          # Add your deployment steps here (e.g., SSH, kubectl, etc.)

  rollback:
    name: Rollback Production Deployment
    runs-on: ubuntu-latest
    if: failure()
    needs: deploy

    steps:
      - name: Rollback to previous version
        run: |
          echo "Rolling back to the previous version..."
          # Add your rollback steps here
