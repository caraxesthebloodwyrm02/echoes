[tox]
# Test on main supported Python versions
envlist = py312, py313
skip_missing_interpreters = true

[testenv]
deps =
    -r requirements.txt
    pytest>=8.0.0
    pytest-cov>=4.0.0
    pytest-xdist>=3.0.0
    black>=24.0.0
    ruff>=0.1.0
    mypy>=1.0.0
commands =
    # Install package in development mode
    pip install -e .

    # Run code quality checks
    black --check --diff .
    ruff check .
    mypy . --ignore-missing-imports || true

    # Run tests
    pytest tests/ -v --tb=short --cov=echoes --cov-report=term-missing --cov-report=xml --cov-fail-under=50 || true

    # Run API key check (skip fail if key unset)
    python scripts/utilities/check_api_key.py || echo "API key check skipped (expected)"

[testenv:py312]
basepython = python3.12

[testenv:py313]
basepython = python3.13
